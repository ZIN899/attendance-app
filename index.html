<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>å‡ºå¸­ç¢ºèª</title>
<style>
body {
    font-family: "Yu Gothic", sans-serif;
    padding: 20px;
}
.container {
    max-width: 350px;
    margin: 0 auto;
}
input, button {
    width: 100%;
    padding: 12px;
    margin-top: 10px;
    font-size: 16px;
}
</style>
</head>
<body>

<div class="container">
    <h2>å‡ºå¸­ç¢ºèª</h2>

    <label>åå‰ï¼ˆå­¦ç”Ÿåï¼‰</label>
    <input type="text" id="name" placeholder="ä¾‹ï¼šã‚¸ãƒ³ãƒãƒ¼ãƒ">

    <button onclick="submitAttendance()">é€ä¿¡</button>
</div>

<script>
// æ™‚é–“å‰²ãƒ‡ãƒ¼ã‚¿
const timetable = {
    "æœˆ": [
        { subject: "ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°", start: "09:20", end: "10:50" },
        { subject: "è·æ¥­ã¨ã‚­ãƒ£ãƒªã‚¢", start: "11:00", end: "12:30" },
        { subject: "AIé–‹ç™º", start: "13:20", end: "14:50" }
    ],
    "ç«": [
        { subject: "ICTæ´»ç”¨", start: "09:20", end: "10:50" },
        { subject: "ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚¨ãƒ³ã‚¹", start: "11:00", end: "12:30" },
        { subject: "PBL", start: "13:20", end: "14:50" }
    ],
    "æœ¨": [
        { subject: "ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°", start: "09:20", end: "10:50" },
        { subject: "æ—¥æœ¬èª", start: "11:00", end: "12:30" }
    ],
    "é‡‘": [
        { subject: "æƒ…å ±", start: "09:20", end: "10:50" },
        { subject: "çµŒå–¶æˆ¦ç•¥ã¨AIãƒ“ã‚¸ãƒã‚¹", start: "11:00", end: "12:30" }
    ]
};

// ç¾åœ¨ã®æˆæ¥­ã‚’åˆ¤æ–­ã™ã‚‹
function detectClass() {
    const now = new Date();
    const dayNames = ["æ—¥","æœˆ","ç«","æ°´","æœ¨","é‡‘","åœŸ"];
    const day = dayNames[now.getDay()];

    const current = now.toTimeString().slice(0,5);
    const todayClasses = timetable[day];

    if (!todayClasses) return "ï¼ˆæˆæ¥­ãªã—ï¼‰";

    for (let c of todayClasses) {
        if (current >= c.start && current <= c.end) {
            return c.subject;
        }
    }
    return "ï¼ˆæˆæ¥­æ™‚é–“å¤–ï¼‰";
}

// å‡ºå¸­é€ä¿¡
function submitAttendance() {
    const name = document.getElementById("name").value;
    if (!name) {
        alert("åå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");
        return;
    }

    const now = new Date();
    const data = {
        name: name,
        time: now.toLocaleString(),
        class: detectClass()
    };

    fetch("https://api.github.com/repos/ZIN899/attendance-app/dispatches", {
        method: "POST",
        headers: {
            "Accept": "application/vnd.github+json",
            "Authorization": "Bearer ghp_xxxxxx"  // ğŸ”¥ å¾Œã§å®‰å…¨ã«ç½®ãæ›ãˆã‚‹
        },
        body: JSON.stringify({
            event_type: "save-attendance",
            client_payload: { data: JSON.stringify(data) }
        })
    })
    .then(() => {
        alert("å‡ºå¸­ã‚’è¨˜éŒ²ã—ã¾ã—ãŸï¼\n\nåå‰: " + name + "\næ™‚åˆ»: " + data.time);
    });
}
</script>

</body>
</html>

